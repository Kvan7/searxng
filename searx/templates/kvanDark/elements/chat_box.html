<aside class="chat_box" aria-label="{{ chat_box.chat_box }}">
    <h2 class="title"><bdi>{{ chat_box.chat_box }}</bdi></h2>
    <p><bdi>{{ chat_box.content | safe }}</bdi></p>
</aside>
<script>
    window.onload = function () {
        // Extract the 'q' parameter from the search URL in the sidebar
        const searchUrl = document.querySelector('#search_url pre').textContent;
        const url = new URL(searchUrl);
        const query = url.searchParams.get('q');

        fetch('/generate-chat-content', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ query: query }),
        })
            .then(response => response.json())
            .then(data => {
                const chatBox = document.querySelector('.chat_box');
                chatBox.querySelector('h2 bdi').style.display = 'none';
                chatBox.querySelector('p bdi').innerHTML = data.content;
            });
    };
</script>